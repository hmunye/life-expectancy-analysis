---
title: "Report Draft"
format: html
editor: visual
author: Group 5
Group Leader: Mackenzie Hiddie
Group Members: Adam Thomas, Yusuf Unsal, Austin Perkins, Justyn Kovalsk, Huseen Munye
---

# Table of Contents

-   **1** [1 Introduction]

    -   1.1 Data Understanding

    -   1.2 Data Source

    -   1.3 Initial questions

-   **2 Data Loading**

    -   2.1 Importing Libraries

    -   2.2 Loading & Understanding the Data

    -   2.3 Categorizing Datasets Attributes

-   **3 Data Cleaning**

    -   3.1 Handling Null Values

        -   3.1.1 Treating Null Values

        -   3.1.2 Decision for Treating Null Values

        -   3.1.3 Approach

    -   3.2 Handling Outliers

        -   3.2.1 Treating Outliers

        -   3.2.2 Decision for Treating Outliers

        -   3.2.3 Approach

-   **4 Data Analysis**

    -   4.1 Plots

    -   4.2 Variance Analysis

    -   4.3 Covariance Analysis

-   5 Models

    -   5.1 Multiple Regression on Life Exoectancy

    -   5.2 I dunno yet

    -   5.3 ...

## 1 Introduction

This Document is prepared by Group 5 under the supervision of Mackenzie Hiddie.

The group members contributing to this document include:

-   Adam Thomas

-   Huseen Munye

-   Yusuf Unsal

-   Austin Perkins

-   Justyn Kovalsk

This dataset includes comprehensive information on 179 countries spanning from 2000 to 2015, covering aspects like life expectancy, health indicators, immunization rates, and economic and demographic data. Originally sourced from Kaggle, it underwent updates to rectify inaccuracies and missing values. Population, GDP, and life expectancy figures were updated from World Bank data, while data on vaccinations, alcohol consumption, BMI, HIV rates, mortality, and other health metrics were sourced from the World Health Organization. Additional information on schooling was gathered from the University of Oxford's Our World in Data project. Missing values were addressed using strategies such as filling with the closest three-year average or the regional average. Countries with significant missing data were excluded, and the remaining countries were categorized based on their Gross National Income per capita into developed vs developing economies, following guidelines from organizations like the World Trade Organization and the UN.

#### 1.1 Data Understanding

Columns in the dataset:

-   **Country:** List of the 179 countries

-   **Region:** 179 countries are distributed in 9 regions. E.g. Africa, Asia, Oceania, European Union, Rest of Europe and etc.

-   **Year:** Years observed from 2000 to 2015

-   **Infant_deaths:** Represents infant deaths per 1000 population

-   **Under_five_deaths:** Represents deaths of children under five years old per 1000 population

-   **Adult_mortality:** Represents deaths of adults per 1000 population

-   **Alcohol_consumption:** Represents alcohol consumption that is recorded in liters of pure alcohol per capita with 15+ years old

-   **Hepatitis_B:** Represents % of coverage of Hepatitis B (HepB3) immunization among 1-year-olds

-   **Measles:** Represents % of coverage of Measles containing vaccine first dose (MCV1) immunization among 1-year-olds

-   **BMI:** BMI is a measure of nutritional status in adults. It is defined as a person's weight in kilograms divided by the square of that person's height in meters (kg/m2)

-   **Polio:** Represents % of coverage of Polio (Pol3) immunization among 1-year-olds

-   **Diphtheria:** Represents % of coverage of Diphtheria tetanus toxoid and pertussis (DTP3) immunization among 1-year-olds

-   **Incidents_HIV:** Incidents of HIV per 1000 population aged 15-49

-   **GDP_per_capita:** GDP per capita in current USD

-   **Population_mln:** Total population in millions

-   **Thinness_ten_nineteen_years:** Prevalence of thinness among adolescents aged 10-19 years. BMI \< -2 standard deviations below the median

-   **Thinness_five_nine_years:** Prevalence of thinness among children aged 5-9 years. BMI \< -2 standard deviations below the median

-   **Schooling:** Average years that people aged 25+ spent in formal education

-   **Economy_status_Developed:** Developed country

-   **Economy_status_Developing:** Developing county

-   **Life_expectancy:** Average life expectancy of both genders in different years from 2010 to 2015

#### 1.2 Data Source

Original dataset can be found here: <https://www.kaggle.com/datasets/lashagoch/life-expectancy-who-updated>

For ease of use we have re-uploaded the dataset to this Github repository created for this group project:

<https://raw.githubusercontent.com/hmunye/life-expectancy-analysis/main/data/Life-Expectancy-Data-Updated.csv>

### 1.3 Initial Questions

## 2 Data Loading

#### 2.1 Importing Libraries

Install the packages if not already installed on your machine

```{r}
install.packages("tidyverse")
```

```{r}
install.packages("caret")
```

```{r}
#import the needed libraries 
library(tidyverse)
library(caret)
```

#### 2.2 Loading and Understanding the Data

Load the dataset from the group GitHub repository:

```{r}

df <- read_csv("https://raw.githubusercontent.com/hmunye/life-expectancy-analysis/main/data/Life-Expectancy-Data-Updated.csv", show_col_types = FALSE)

```

Display the first 5 rows of the dataset:

```{r}
head(df, 5)
```

The shape of the data frame

```{r}
# Get the number of rows
num_rows <- nrow(df)

# Get the number of columns
num_cols <- ncol(df)

# Print the results
cat("Number of rows:", num_rows, "\n")
cat("Number of columns:", num_cols, "\n")
```

Summary of the Data Frame:

```{r}
summary(df)

```

#### 2.3 Categorizing the Datasets Attributes

-   Nominal (Factors)

    -   Country

    -   Region

    -   Economy_status_Developed

    -   Economy_status_Developing

-   Numerical (Nominal):

    -   Year

    -   Infant_deaths

    -   Under_five_deaths

-   Numerical (Interval)

    -   BMI

-   Numerical (Ratio)

    -   Life_expectancy
    -   Adult_mortality
    -   Hepatitis_B
    -   Measles
    -   Polio
    -   Incidents_HIV
    -   GDP_per_capita
    -   Population_mln
    -   Thinness_five_nine_years
    -   Thinness_ten_nineteen_years
    -   Schooling

-   Put Reasoning here (Why each is what it is)

    -   **Someone please double check me.**

------------------------------------------------------------------------

Creating a list of all nominal/factors

Regions

```{r}
df |>
distinct(Region)
```

Country

```{r}
df |>
  distinct(Country)
```

Year

```{r}
df |>
distinct(Year)
```

Economic Status:

```{r}
df |>
distinct(Economy_status_Developed)
df |>
distinct(Economy_status_Developing)
```

For the purpose of analysis in R, it is a good practice to change the categorical variables into factors

```{r}
df$Country <- factor(df$Country)
df$Region <- factor(df$Region)
df$Region <- factor(df$Region)
df$Year <- factor(df$Year)
df$Economy_status_Developed <- factor(df$Economy_status_Developed)
df$Economy_status_Developing <- factor(df$Economy_status_Developing)

glimpse(df)
```

## 3 Data Cleaning

### 3.1 Handling Null Values

The original data set had several hundred missing values. While the data is publicly available as it is all published by the various nations of the world and the World Heath Organization, it is not feasible with our teams man hours to manually enter each missing value.

**Number of Missing Values:**

Life_expectancy: 10

Adult_mortality: 10

Infant_deaths: 0

Hepatitis_B: 553

Measles: 0

BMI: 34

Under_five_deaths: 0

Polio: 19

Incidents_HIV: 0

GDP_per_capita: 448

Population_mln: 652

Thinness_five_nine_years: 34

Schooling: 163

#### 3.1.1 Treating Null Values

1\) Delete the row: Possible for datasets with small number of NA's, sadly that is not our dataset.

#### 3.1.2 Decision for Treating Null Values

When doing research on how to handle the missing values, Our group leader found a data set that has already "fixed" the missing values. This new data set first grouped each country into regions, from there the average value of each column was found by region. This is a very clean way to ensure that different regions do not effect each other, while still filling in the missing values.

#### 3.1.3 Approach

The group moved forward with the "Fixed" dataset.

### 3.2 Handling Outliers

Function to Find Number of Outliers and Plot:

```{r}
num_outliers <- function(data_set, column) {
  q1 <- quantile(column, 0.25)
  q3 <- quantile(column, 0.75)
  iqr <- q3 -q1
  
  upper_bound <- q3 + 1.5 * iqr
  lower_bound <- q1 - 1.5 * iqr
  
  outliers <- column[column < lower_bound | column > upper_bound]
  
  plot <- ggplot(data_set) + geom_boxplot(aes(x = "", y = column))
  
  print(plot)
  
  return(length(outliers))
}
```

**Number of Outliers:**

Life_expectancy:

```{r}
num_outliers(df, df$Life_expectancy)
```

Adult_mortality:

```{r}
num_outliers(df, df$Adult_mortality)
```

Alcohol_consumption:

```{r}
num_outliers(df, df$Alcohol_consumption)
```

Hepatitis_B:

```{r}
num_outliers(df, df$Hepatitis_B)
```

Measles:

```{r}
num_outliers(df, df$Measles)
```

Polio:

```{r}
num_outliers(df, df$Polio)
```

Diphtheria:

```{r}
num_outliers(df, df$Diphtheria)
```

Incidents_HIV:

```{r}
num_outliers(df, df$Incidents_HIV)
```

GDP_per_capita:

```{r}
num_outliers(df, df$GDP_per_capita)
```

Population_mln:

```{r}
num_outliers(df, df$Population_mln)
```

Thinness_five_nine_years:

```{r}
num_outliers(df, df$Thinness_five_nine_years)
```

Thinness_ten_nineteen_years:

```{r}
num_outliers(df, df$Thinness_ten_nineteen_years)
```

Schooling:

```{r}
num_outliers(df, df$Schooling)
```

BMI:

```{r}
num_outliers(df, df$BMI)
```

Infant_deaths:

```{r}
num_outliers(df, df$Infant_deaths)
```

Under_five_deaths:

```{r}
num_outliers(df, df$Under_five_deaths)
```

#### 3.2.1 Treating Outliers

**1) Trimming**: Remove outliers from the dataset. This approach can be appropriate if the outliers are deemed to be data entry errors or highly improbable values. Due to the high number of outliers in the dataset, this is not a viable option.

**2) Winsorization**: Replace outliers with values at a specified percentile (e.g., replacing values above the 95th percentile with the 95th percentile value, replacing values below the 5th percentile with the 5th percentile value).

#### 3.2.2 Decision for Treating Outliers

After doing research on how to identify and treat outliers in R,

#### 3.2.3 Approach

## 4 Data Analysis

#### 4.1 Plots

```{r}
covariance_plot <- function(y_val, x_val, data_frame, std_data_frame) {
  ggplot(data = data_frame, aes_string(y = y_val, x = x_val, color = "Region")) +
    geom_point() +
    geom_text(aes(label = paste("Covariance:", round(cov(std_data_frame[[y_val]], std_data_frame[[x_val]]), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
}
```

#### 4.2 Variance Analysis

Life Expectancy

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Life_expectancy))

df |>
ggplot() +
    geom_histogram(aes(x=df$Life_expectancy), bins = 30)

summary(df$Life_expectancy)
```

------------------------------------------------------------------------

Inference:

Life Expectancy represents the average years lived in the given country

Life Expectancy is not evenly distributed,

Life Expectancy peaks \~71

The minimum is 39.40, the max is 83.8

Conclusion:

------------------------------------------------------------------------

Infant Deaths

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Infant_deaths))

df |>
ggplot() +
    geom_histogram(aes(x=df$Infant_deaths), bins = 30)

summary(df$Infant_deaths)
```

Inference:

It represents the Infant Deaths in the given country

Life Expectancy is not evenly distributed,

Life Expectancy peaks \~20

The minimum is 1.80, the max is 138.10

Conclusion:

------------------------------------------------------------------------

Under_five_deaths

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Under_five_deaths))

df |>
ggplot() +
    geom_histogram(aes(x=df$Under_five_deaths), bins = 30)

summary(df$Under_five_deaths)
```

Inference:

Life Expectancy represents the average deaths under five (age) in the given country

Life Expectancy is not evenly distributed,

Life Expectancy peaks \~23

The minimum is 2.30, the max is 224.90

Conclusion:

------------------------------------------------------------------------

Adult_mortality

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Adult_mortality))

df |>
ggplot() +
    geom_histogram(aes(x=df$Adult_mortality), bins = 30)

summary(df$Adult_mortality)
```

Inference:

Adult mortality represents the adult deaths in the given country

Life Expectancy is not evenly distributed,

Adult mortality peaks \~164

The minimum is 49.38, the max is 719.36

Conclusion:

------------------------------------------------------------------------

Alcohol Consumption

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Alcohol_consumption))

df |>
ggplot() +
    geom_histogram(aes(x=df$Alcohol_consumption), bins = 30)

summary(df$Alcohol_consumption)
```

Inference:

Alcohol consumption is recorded per capita (15+) consumption (in litres of pure alcohol)

Min is 0 litres

Max is 17.87

Alcohol consumption is not evenly distrusted.

Alchohol Consumption peaks at 0

Conclusion:

------------------------------------------------------------------------

\$Hepatitis_B

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Hepatitis_B))

df |>
ggplot() +
    geom_histogram(aes(x=df$Hepatitis_B), bins = 30)

summary(df$Hepatitis_B)
```

Hepatitis Inferences:

Hepatitis B represents the immunization coverage among 1-year olds(%)

It is not evenly distrusted

min: 12

Max 99.9

It peaks around 90%

------------------------------------------------------------------------

Measles

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Measles))

df |>
ggplot() +
    geom_histogram(aes(x=df$Measles), bins = 30)

summary(df$Measles)

```

Measles Influences:

Measles represents the percentage of 1 year olds who have been immunized

It is not evenly distrusted

Min 10

Max 99

It peaks around 62%

------------------------------------------------------------------------

BMI

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$BMI))

df |>
ggplot() +
    geom_histogram(aes(x=df$BMI), bins = 30)

summary(df$Polio)
```

BMI Inferences:

BMI represents the nutritional status of the adult population

It is not evenly distributed

Min 8

Max 99

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Polio))

df |>
ggplot() +
    geom_histogram(aes(x=df$Polio), bins = 30)

summary(df$Polio)
```

Diphtheria

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Diphtheria))

df |>
ggplot() +
    geom_histogram(aes(x=df$Diphtheria), bins = 30)

summary(df$Diphtheria)
```

HIV

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Incidents_HIV))

df |>
ggplot() +
    geom_histogram(aes(x=df$Incidents_HIV), bins = 30)

summary(df$Incidents_HIV)
```

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$GDP_per_capita))

df |>
ggplot() +
    geom_histogram(aes(x=df$GDP_per_capita), bins = 30)

summary(df$GDP_per_capita)
```

Population

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Population_mln))

df |>
ggplot() +
    geom_histogram(aes(x=df$Population_mln), bins = 100) 

#re-do of the graph with xlim to exclude the outliers 
df |>
ggplot() +
    geom_histogram(aes(x=df$Population_mln), bins = 30) +
  xlim(0,350)

summary(df$Population_mln)
```

Thinness 10 to 19

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Thinness_ten_nineteen_years))

df |>
ggplot() +
    geom_histogram(aes(x=df$Thinness_ten_nineteen_years), bins = 30)

summary(df$Thinness_ten_nineteen_years)
```

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Thinness_five_nine_years))

df |>
ggplot() +
    geom_histogram(aes(x=df$Thinness_five_nine_years), bins = 30)

summary(df$Thinness_five_nine_years)
```

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Schooling))

df |>
ggplot() +
    geom_histogram(aes(x=df$Schooling), bins = 30)

summary(df$Schooling)
```

#### 4.3 Covariance Analysis

For Covariance Analysis we need a subset of the data that only has the numeric variables

Standardize the data

```{r}
sdf <- df |>
  select(-Year, everything()) |>
  mutate(across(where(is.numeric), scale))
```

```{r}
#get only numeric data
numeric_data <- select_if(sdf, is.numeric)

#remove categorical values that are numeric
numeric_data <- numeric_data |>
   select(-Year, -Economy_status_Developed, -Economy_status_Developing)

cov_matrix <- cov(numeric_data)

print(cov_matrix)
```

Life Expectancy:

```{r}
df |>
  ggplot(aes(y = Life_expectancy, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Life_expectancy, sdf$Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



df |>
  ggplot(aes(y = Life_expectancy, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Life_expectancy, sdf$Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")




df |>
  ggplot(aes(y = Life_expectancy, x = Under_five_deaths, color = Region)) +
  geom_point()  +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Life_expectancy, sdf$Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



df |>
  ggplot(aes(y = Life_expectancy, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Life_expectancy, sdf$Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



df |>
  ggplot(aes(y = Life_expectancy, x = Hepatitis_B, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Life_expectancy, sdf$Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



df |>
  ggplot(aes(y = Life_expectancy, x = Measles,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Life_expectancy, sdf$Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



df |>
  ggplot(aes(y = Life_expectancy, x =  BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Life_expectancy, sdf$BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



df |>
  ggplot(aes(y = Life_expectancy, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Life_expectancy, sdf$Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")




df |>
  ggplot(aes(y = Life_expectancy, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Life_expectancy, sdf$Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



df |>
  ggplot(aes(y = Life_expectancy, x = Incidents_HIV, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Life_expectancy, sdf$Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



df |>
  ggplot(aes(y = Life_expectancy, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Life_expectancy, sdf$GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")




df |>
  ggplot(aes(y = Life_expectancy, x = Population_mln, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Life_expectancy, sdf$Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


  
df |>
  ggplot(aes(y = Life_expectancy, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Life_expectancy, sdf$Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



  
df |>
  ggplot(aes(y = Life_expectancy, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Life_expectancy, sdf$Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Life_expectancy, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Life_expectancy, sdf$Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")






```

Inference:

Adult Mortality, Infant Deaths, Under 5 deaths all have a strong negative relationships with Life Expectancy.

Alcohol Consumption, BMI, Polio, Diphteria, and Schooling all have positive relationships with Life Expectancy

Alcohol:

```{r}
df |>
  ggplot(aes(y = Alcohol_consumption, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Alcohol_consumption, sdf$Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Alcohol_consumption, sdf$Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = Hepatitis_B, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Alcohol_consumption, sdf$Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = Measles, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Alcohol_consumption, sdf$Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Alcohol_consumption, sdf$BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Alcohol_consumption, sdf$Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Alcohol_consumption, sdf$Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = Incidents_HIV, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Alcohol_consumption, sdf$Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Alcohol_consumption, sdf$GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = Population_mln, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Alcohol_consumption, Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = Schooling, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Alcohol_consumption, sdf$Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

Inferences:

There is a positive relationship between Schooling and alcohol consumption,

Other variables have some covariance, but it dose not seem to be strongly related.

GDP:

```{r}

df |>
  ggplot(aes(y = GDP_per_capita, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$GDP_per_capita, sdf$Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$GDP_per_capita, sdf$Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$GDP_per_capita, sdf$Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$GDP_per_capita, sdf$Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Hepatitis_B, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$GDP_per_capita, sdf$Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$GDP_per_capita, sdf$Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Hepatitis_B, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$GDP_per_capita, sdf$Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Population_mln, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$GDP_per_capita, sdf$Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$GDP_per_capita, sdf$Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Thinness_five_nine_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$GDP_per_capita, sdf$Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = GDP_per_capita, x = Schooling, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$GDP_per_capita, sdf$Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

Inference:

There appears to be a positive relationship between Schooling and GDP, as well as a slight positive relationship between Alcohol Consumption and GDP

Adult Mortality

```{r}
df |>
  ggplot(aes(y = Adult_mortality, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Adult_mortality, sdf$Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Adult_mortality, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Adult_mortality, sdf$Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Adult_mortality, sdf$Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Adult_mortality, sdf$Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = Hepatitis_B, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Adult_mortality, sdf$Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = Measles,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Adult_mortality, sdf$Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x =  BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Adult_mortality, sdf$BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Adult_mortality, sdf$Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Adult_mortality, sdf$Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = Incidents_HIV, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Adult_mortality, sdf$Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Adult_mortality, sdf$GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = Population_mln, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Adult_mortality, sdf$Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Adult_mortality, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Adult_mortality, sdf$Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Adult_mortality, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Adult_mortality, sdf$Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Adult_mortality, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Adult_mortality, sdf$Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

```

Inferences:

There is a strong negative correlation between Adult Mortality and life expectancy.

There are negative correlations between Adult Mortality and BMI, Diptheria, and schooling.

There are strong positive correlations between Adult Morality and Adult Mortality, Infant Deaths, and Under Five Deaths

Hepatitis B

```{r}

df |>
  ggplot(aes(y =  Hepatitis_B, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Hepatitis_B, sdf$Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Hepatitis_B, sdf$Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Hepatitis_B, sdf$Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Hepatitis_B, sdf$Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Hepatitis_B, sdf$Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = Measles,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Hepatitis_B, sdf$Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x =  BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Hepatitis_B, sdf$BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Hepatitis_B, sdf$Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Hepatitis_B, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Hepatitis_B, sdf$Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = Incidents_HIV, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Hepatitis_B, sdf$Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Hepatitis_B, sdf$GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = Population_mln, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Hepatitis_B, sdf$Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Hepatitis_B, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Hepatitis_B, sdf$Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Hepatitis_B, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Hepatitis_B, sdf$Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Hepatitis_B, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Hepatitis_B, sdf$Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

Hepatitis B Inferences:

Strong Positive: Diphtheria,

Positive: Life Expectancy, Alcohol Consumption, Polio

Negative: Infant Deaths, Under Five Deaths, Adult mortality,

Measles

```{r}
df |>
  ggplot(aes(y =  Measles, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Measles, sdf$Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Measles, sdf$Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Measles, sdf$Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Measles, sdf$Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Measles, sdf$Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Hepatitis_B,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Measles, sdf$Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x =  BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Measles, sdf$BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Measles, sdf$Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Measles, sdf$Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Incidents_HIV, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Measles, sdf$Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Measles, sdf$GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Population_mln, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Measles, sdf$Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Measles, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Measles, sdf$Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Measles, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Measles, sdf$Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Measles, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Measles, sdf$Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

Measles Inferences:

Positive: Life Expectancy, Schooling

Negative: Infant Deaths, Under Five Deaths

BMI

```{r}
df |>
  ggplot(aes(y =  BMI, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$BMI, sdf$Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$BMI, sdf$Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$BMI, sdf$Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$BMI, sdf$Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$BMI, sdf$Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Hepatitis_B,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$BMI, sdf$Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x =  Measles, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$BMI, sdf$Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$BMI, sdf$Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$BMI, sdf$Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Incidents_HIV, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$BMI, sdf$Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$BMI, sdf$GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Population_mln, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$BMI, sdf$Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = BMI, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$BMI, sdf$Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = BMI, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$BMI, sdf$Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = BMI, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$BMI, sdf$Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

BMI Inferences:

Strong Positive: Life Expectancy, Schooling

Positive: Diphtheria, GDP

Negative: Thinness

Strong Negative: Infant Deaths, Under Five Deaths, Adult Mortality,

Polio

```{r}

df |>
  ggplot(aes(y = Polio, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Polio, sdf$Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Polio, sdf$Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Polio, sdf$Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Polio, sdf$Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Polio, sdf$Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = Hepatitis_B,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Polio, sdf$Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x =  Measles, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Polio, sdf$Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Polio, sdf$BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Polio, sdf$Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = Incidents_HIV, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Polio, sdf$Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Polio, sdf$GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = Population_mln, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Polio, sdf$Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Polio, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Polio, sdf$Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Polio, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Polio, sdf$Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Polio, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Polio, sdf$Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

```

Polio Inferences:

Strong Positive, Hepatitis B, Diphtheria,

Positive: Polio, BMI, Schooling

Negative, Thinness

Strong Negative: Infant Deaths, Under Five deaths,

Diphtheria

```{r}
df |>
  ggplot(aes(y = Diphtheria, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Diphtheria, sdf$Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Diphtheria, sdf$Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Diphtheria, sdf$Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Diphtheria, sdf$Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Diphtheria, sdf$Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = Hepatitis_B,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Diphtheria, sdf$Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x =  Measles, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Diphtheria, sdf$Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Diphtheria, sdf$BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Diphtheria, sdf$Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = Incidents_HIV, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Diphtheria, sdf$Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Diphtheria, sdf$GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = Population_mln, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Diphtheria, sdf$Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Diphtheria, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Diphtheria, sdf$Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Diphtheria, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Diphtheria, sdf$Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Diphtheria, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Diphtheria, sdf$Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

Diphtheria Inferences:

Strong Positive: Hepatitis B, Polio

Positive: Life Expectancy, Measles, BMI, Schooling

Negative, Thinness

Strong Negative: Infant Deaths, Under Five Deaths, Diphtheria

HIV

```{r}
df |>
  ggplot(aes(y = Incidents_HIV, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Incidents_HIV, sdf$Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Incidents_HIV, sdf$Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Incidents_HIV, sdf$Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Incidents_HIV, sdf$Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Incidents_HIV, sdf$Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = Hepatitis_B,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Incidents_HIV, sdf$Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x =  Measles, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Incidents_HIV, sdf$Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Incidents_HIV, sdf$BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Incidents_HIV, sdf$Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Incidents_HIV, sdf$Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Incidents_HIV, sdf$GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = Population_mln, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Incidents_HIV, sdf$Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Incidents_HIV, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Incidents_HIV, sdf$Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Incidents_HIV, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Incidents_HIV, sdf$Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Incidents_HIV, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Incidents_HIV, sdf$Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

HIV Inferences:

Conclusion: We may want to separate out Africa for this one, as it seems to be skewing the data.

Population

```{r}
df |>
  ggplot(aes(y = Population_mln, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Population_mln, sdf$Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Population_mln, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Population_mln, sdf$Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Population_mln, sdf$Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Population_mln, sdf$Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Population_mln, sdf$Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = Hepatitis_B,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Population_mln, sdf$Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x =  Measles, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Population_mln, sdf$Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Population_mln, sdf$BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Population_mln, sdf$Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Population_mln, sdf$Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Population_mln, sdf$GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = Incidents_HIV, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Population_mln, sdf$Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Population_mln, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Population_mln, sdf$Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Population_mln, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Population_mln, sdf$Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Population_mln, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Population_mln, sdf$Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

```

Population Inferences:

We may want to do this again without China and India, as they seems to be skewing the data

Thinness

```{r}
df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Thinness_ten_nineteen_years, sdf$Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Thinness_ten_nineteen_years, sdf$Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Thinness_ten_nineteen_years, sdf$Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Thinness_ten_nineteen_years, sdf$Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Thinness_ten_nineteen_years, sdf$Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Hepatitis_B,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Thinness_ten_nineteen_years, sdf$Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x =  Measles, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Thinness_ten_nineteen_years, sdf$Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Thinness_ten_nineteen_years, sdf$BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Thinness_ten_nineteen_years, sdf$Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Thinness_ten_nineteen_years, sdf$Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Thinness_ten_nineteen_years, sdf$GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Incidents_HIV, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Thinness_ten_nineteen_years, sdf$Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Population_mln, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Thinness_ten_nineteen_years, sdf$Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Thinness_ten_nineteen_years, sdf$Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Thinness_ten_nineteen_years, sdf$Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

Thinness:

Strong positive:

Positive: Infant deaths, under five deaths, adult mortality, HIV, population

Negative: Life expectancy, alcohol consumption, Hepatitis B, measles, BMI, polio, diphtheria, schooling

Strong negative: GDP

No surprise that the two thinness are basically one to one.

Schooling

```{r}
df |>
  ggplot(aes(y = Schooling, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Schooling, sdf$Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Schooling, sdf$Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Schooling, sdf$Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Schooling, sdf$Alcohol_consumption ), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Schooling, sdf$Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = Hepatitis_B,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Schooling, sdf$Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x =  Measles, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Schooling, sdf$Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Schooling, sdf$BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Schooling, sdf$Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Schooling, sdf$Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Schooling, sdf$GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = Incidents_HIV, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Schooling, sdf$Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Schooling, x = Population_mln, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Schooling, sdf$Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Schooling, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Schooling, sdf$Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Schooling, x = Thinness_ten_nineteen_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(sdf$Schooling, sdf$Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

Inferences:

There is a positive relationship between life expectancy and schooling so the higher the number of years in school, the higher the life expectancy.

There is a negative correlation between infant deaths and schooling so the higher the number of years in school, the lower the amount of infant deaths.

There is a negative correlation between under 5 deaths and schooling so the higher the number of years in school, the lower the amount of under 5 deaths.

There is a positive correlation between alcohol consumption and schooling so the higher the number of years in school, the higher the amount of alcohol consumption.

There is a negative correlation between adult mortality and schooling so the higher the number of years in school, the lower the adult mortality rates.

There is a positive correlation between hepatitis B and schooling so the higher the number of years in school, the higher the hepatitis B immunization coverage.

There is a positive correlation between measles and schooling so the higher the number of years in school, the higher the measles immunization coverage.

There is a slight positive correlation between BMI and schooling so the higher the number of years in school, the higher the average BMI.

There is a positive correlation between polio and schooling so the higher the number of years in school, the higher the polio immunization coverage.

Positive correlation for diphtheria.

Positive correlation for GDP.

Negative correlation for HIV.

Negative correlation for population.

Negative correlation for thinness.

## 5 Models

#### 5.1 Multiple Regression of Life Expectancy

For testing purposes, we must separate out a portion of the data now. We will be using a 80/20 split. 80% Training, 20% testing.

```{r}

#seed to make this reproducible 
set.seed(333)

#split the data
training.samples <- sdf |> createDataPartiton(p = 0.8, list = FALSE)

train.data <- sdf[training.samples, ]
test.data <- sdf[-training.samples, ]
```

#### 5.2 ???

#### 5.3 ????
