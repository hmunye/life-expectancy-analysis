---
title: "Report Draft"
format: html
editor: visual
author: Group 5
---

# Table of Contents

-   **1 Introduction**

    -   1.1 Data Understanding

    -   1.2 Data Source

-   **2 Data Loading**

    -   2.1 Importing Libraries

    -   2.2 Loading & Understanding the Data

    -   2.3 Categorizing Datasets Attributes

-   **3 Data Cleaning**

    -   3.1 Handling Null Values

        -   3.1.1 Treating Null Values

        -   3.1.2 Decision for Treating Null Values

        -   3.1.3 Approach

    -   3.2 Handling Outliers

        -   3.2.1 Treating Outliers

        -   3.2.2 Decision for Treating Outliers

        -   3.2.3 Approach

-   **4 Data Analysis**

    -   4.1 Plots

    -   4.2 Variance Analysis

    -   4.3 Covariance Analysis

-   **5 Final Conclusions**

    -   5.1 Variance Analysis

    -   5.2 Covariance Analysis

## 1 Introduction

This dataset includes comprehensive information on 179 countries spanning from 2000 to 2015, covering aspects like life expectancy, health indicators, immunization rates, and economic and demographic data. Originally sourced from Kaggle, it underwent updates to rectify inaccuracies and missing values. Population, GDP, and life expectancy figures were updated from World Bank data, while data on vaccinations, alcohol consumption, BMI, HIV rates, mortality, and other health metrics were sourced from the World Health Organization. Additional information on schooling was gathered from the University of Oxford's Our World in Data project. Missing values were addressed using strategies such as filling with the closest three-year average or the regional average. Countries with significant missing data were excluded, and the remaining countries were categorized based on their Gross National Income per capita into developed vs developing economies, following guidelines from organizations like the World Trade Organization and the UN.

#### 1.1 Data Understanding

Columns in the dataset:

-   **Country:** List of the 179 countries

-   **Region:** 179 countries are distributed in 9 regions. E.g. Africa, Asia, Oceania, European Union, Rest of Europe and etc.

-   **Year:** Years observed from 2000 to 2015

-   **Infant_deaths:** Represents infant deaths per 1000 population

-   **Under_five_deaths:** Represents deaths of children under five years old per 1000 population

-   **Adult_mortality:** Represents deaths of adults per 1000 population

-   **Alcohol_consumption:** Represents alcohol consumption that is recorded in liters of pure alcohol per capita with 15+ years old

-   **Hepatitis_B:** Represents % of coverage of Hepatitis B (HepB3) immunization among 1-year-olds

-   **Measles:** Represents % of coverage of Measles containing vaccine first dose (MCV1) immunization among 1-year-olds

-   **BMI:** BMI is a measure of nutritional status in adults. It is defined as a person's weight in kilograms divided by the square of that person's height in meters (kg/m2)

-   **Polio:** Represents % of coverage of Polio (Pol3) immunization among 1-year-olds

-   **Diphtheria:** Represents % of coverage of Diphtheria tetanus toxoid and pertussis (DTP3) immunization among 1-year-olds

-   **Incidents_HIV:** Incidents of HIV per 1000 population aged 15-49

-   **GDP_per_capita:** GDP per capita in current USD

-   **Population_mln:** Total population in millions

-   **Thinness_ten_nineteen_years:** Prevalence of thinness among adolescents aged 10-19 years. BMI \< -2 standard deviations below the median

-   **Thinness_five_nine_years:** Prevalence of thinness among children aged 5-9 years. BMI \< -2 standard deviations below the median

-   **Schooling:** Average years that people aged 25+ spent in formal education

-   **Economy_status_Developed:** Developed country

-   **Economy_status_Developing:** Developing county

-   **Life_expectancy:** Average life expectancy of both genders in different years from 2010 to 2015

#### 1.2 Data Source

Original dataset can be found here: <https://www.kaggle.com/datasets/lashagoch/life-expectancy-who-updated>

For ease of use we have re-uploaded the dataset to this Github repository created for this group project:

<https://raw.githubusercontent.com/hmunye/life-expectancy-analysis/main/data/Life-Expectancy-Data-Updated.csv>

## 2 Data Loading

#### 2.1 Importing Libraries

```{r}
library(tidyverse)

```

#### 2.2 Loading and Understanding the Data

Load the dataset from the group GitHub repository:

```{r}

df <- read_csv("https://raw.githubusercontent.com/hmunye/life-expectancy-analysis/main/data/Life-Expectancy-Data-Updated.csv", show_col_types = FALSE)

```

Display the first 5 rows of the dataset:

```{r}
head(df, 5)
```

The shape of the data frame

```{r}
# Get the number of rows
num_rows <- nrow(df)

# Get the number of columns
num_cols <- ncol(df)

# Print the results
cat("Number of rows:", num_rows, "\n")
cat("Number of columns:", num_cols, "\n")
```

Summary of the Data Frame:

```{r}
summary(df)

```

#### 2.3 Categorizing the Datasets Attributes

-   Nominal (Factors)

    -   Country

    -   Region

    -   Economy_status_Developed

    -   Economy_status_Developing

-   Numerical (Nominal):

    -   Year

    -   Infant_deaths

    -   Under_five_deaths

-   Numerical (Interval)

    -   BMI

-   Numerical (Ratio)

    -   Life_expectancy
    -   Adult_mortality
    -   Hepatitis_B
    -   Measles
    -   Polio
    -   Incidents_HIV
    -   GDP_per_capita
    -   Population_mln
    -   Thinness_five_nine_years
    -   Thinness_ten_nineteen_years
    -   Schooling

-   Put Reasoning here (Why each is what it is)

    -   **Someone please double check me.**

------------------------------------------------------------------------

Creating a list of all nominal/factors

Regions

```{r}
df |>
distinct(Region)
```

Country

```{r}
df |>
  distinct(Country)
```

Year

```{r}
df |>
distinct(Year)
```

For the purpose of analysis in R, it is a good practice to change the categorical variables into factors

```{r}
df$Country <- factor(df$Country)
df$Region <- factor(df$Region)
df$Region <- factor(df$Region)
df$Year <- factor(df$Year)

glimpse(df)
```

## 3 Data Cleaning

### 3.1 Handling Null Values

The original data set had several hundred missing values. While the data is publicly available as it is all published by the various nations of the world and the World Heath Organization, it is not feasible with our teams man hours to manually enter each missing value.

**Number of Missing Values:**

Life_expectancy: 10

Adult_mortality: 10

Infant_deaths: 0

Hepatitis_B: 553

Measles: 0

BMI: 34

Under_five_deaths: 0

Polio: 19

Incidents_HIV: 0

GDP_per_capita: 448

Population_mln: 652

Thinness_five_nine_years: 34

Schooling: 163

#### 3.1.1 Treating Null Values

1\) Delete the row: Possible for datasets with small number of NA's, sadly that is not our dataset.

#### 3.1.2 Decision for Treating Null Values

When doing research on how to handle the missing values, Our group leader found a data set that has already "fixed" the missing values. This new data set first grouped each country into regions, from there the average value of each column was found by region. This is a very clean way to ensure that different regions do not effect each other, while still filling in the missing values.

#### 3.1.3 Approach

The group moved forward with the "Fixed" dataset.

### 3.2 Handling Outliers

Function to Find Number of Outliers and Plot:

```{r}
num_outliers <- function(data_set, column) {
  q1 <- quantile(column, 0.25)
  q3 <- quantile(column, 0.75)
  iqr <- q3 -q1
  
  upper_bound <- q3 + 1.5 * iqr
  lower_bound <- q1 - 1.5 * iqr
  
  outliers <- column[column < lower_bound | column > upper_bound]
  
  plot <- ggplot(data_set) + geom_boxplot(aes(x = "", y = column))
  
  print(plot)
  
  return(length(outliers))
}
```

**Number of Outliers:**

Life_expectancy:

```{r}
num_outliers(df, df$Life_expectancy)
```

Adult_mortality:

```{r}
num_outliers(df, df$Adult_mortality)
```

Alcohol_consumption:

```{r}
num_outliers(df, df$Alcohol_consumption)
```

Hepatitis_B:

```{r}
num_outliers(df, df$Hepatitis_B)
```

Measles:

```{r}
num_outliers(df, df$Measles)
```

Polio:

```{r}
num_outliers(df, df$Polio)
```

Diphtheria:

```{r}
num_outliers(df, df$Diphtheria)
```

Incidents_HIV:

```{r}
num_outliers(df, df$Incidents_HIV)
```

GDP_per_capita:

```{r}
num_outliers(df, df$GDP_per_capita)
```

Population_mln:

```{r}
num_outliers(df, df$Population_mln)
```

Thinness_five_nine_years:

```{r}
num_outliers(df, df$Thinness_five_nine_years)
```

Thinness_ten_nineteen_years:

```{r}
num_outliers(df, df$Thinness_ten_nineteen_years)
```

Schooling:

```{r}
num_outliers(df, df$Schooling)
```

BMI:

```{r}
num_outliers(df, df$BMI)
```

Infant_deaths:

```{r}
num_outliers(df, df$Infant_deaths)
```

Under_five_deaths:

```{r}
num_outliers(df, df$Under_five_deaths)
```

#### 3.2.1 Treating Outliers

**1) Trimming**: Remove outliers from the dataset. This approach can be appropriate if the outliers are deemed to be data entry errors or highly improbable values. Due to the high number of outliers in the dataset, this is not a viable option.

**2) Winsorization**: Replace outliers with values at a specified percentile (e.g., replacing values above the 95th percentile with the 95th percentile value, replacing values below the 5th percentile with the 5th percentile value).

#### 3.2.2 Decision for Treating Outliers

After doing research on how to identify and treat outliers in R,

#### 3.2.3 Approach

## 4 Data Analysis

#### 4.1 Plots

#### 4.2 Variance Analysis

Life Expectancy

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Life_expectancy))

df |>
ggplot() +
    geom_histogram(aes(x=df$Life_expectancy), bins = 30)

summary(df$Life_expectancy)
```

------------------------------------------------------------------------

Inference:

Life Expectancy represents the average years lived in the given country

Life Expectancy is not evenly distributed,

Life Expectancy peaks \~71

The minimum is 39.40, the max is 83.8

Conclusion:

------------------------------------------------------------------------

Infant Deaths

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Infant_deaths))

df |>
ggplot() +
    geom_histogram(aes(x=df$Infant_deaths), bins = 30)

summary(df$Infant_deaths)
```

Under_five_deaths

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Under_five_deaths))

df |>
ggplot() +
    geom_histogram(aes(x=df$Under_five_deaths), bins = 30)

summary(df$Under_five_deaths)
```

Adult_mortality

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Adult_mortality))

df |>
ggplot() +
    geom_histogram(aes(x=df$Adult_mortality), bins = 30)

summary(df$Adult_mortality)
```

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Alcohol_consumption))

df |>
ggplot() +
    geom_histogram(aes(x=df$Alcohol_consumption), bins = 30)

summary(df$Alcohol_consumption)
```

\$Hepatitis_B

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Hepatitis_B))

df |>
ggplot() +
    geom_histogram(aes(x=df$Hepatitis_B), bins = 30)

summary(df$Hepatitis_B)
```

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Measles))

df |>
ggplot() +
    geom_histogram(aes(x=df$Measles), bins = 30)

summary(df$Measles)
```

BMI

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$BMI))

df |>
ggplot() +
    geom_histogram(aes(x=df$BMI), bins = 30)

summary(df$Polio)
```

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Polio))

df |>
ggplot() +
    geom_histogram(aes(x=df$Polio), bins = 30)

summary(df$Polio)
```

Diphtheria

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Diphtheria))

df |>
ggplot() +
    geom_histogram(aes(x=df$Diphtheria), bins = 30)

summary(df$Diphtheria)
```

HIV

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Incidents_HIV))

df |>
ggplot() +
    geom_histogram(aes(x=df$Incidents_HIV), bins = 30)

summary(df$Incidents_HIV)
```

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$GDP_per_capita))

df |>
ggplot() +
    geom_histogram(aes(x=df$GDP_per_capita), bins = 30)

summary(df$GDP_per_capita)
```

Population

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Population_mln))

df |>
ggplot() +
    geom_histogram(aes(x=df$Population_mln), bins = 100) 

#re-do of the graph with xlim to exclude the outliers 
df |>
ggplot() +
    geom_histogram(aes(x=df$Population_mln), bins = 30) +
  xlim(0,350)

summary(df$Population_mln)
```

Thinness 10 to 19

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Thinness_ten_nineteen_years))

df |>
ggplot() +
    geom_histogram(aes(x=df$Thinness_ten_nineteen_years), bins = 30)

summary(df$Thinness_ten_nineteen_years)
```

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Thinness_five_nine_years))

df |>
ggplot() +
    geom_histogram(aes(x=df$Thinness_five_nine_years), bins = 30)

summary(df$Thinness_five_nine_years)
```

```{r}
df |>
ggplot() +
    geom_boxplot(aes(x=0, y=df$Schooling))

df |>
ggplot() +
    geom_histogram(aes(x=df$Schooling), bins = 30)

summary(df$Schooling)
```

#### 4.3 Covariance Analysis

For Covariance Analysis we need a subset of the data that only has the numeric variables

```{r}
#get only numeric data
numeric_data <- select_if(data, is.numeric)

#remove categorical values that are numeric
numeric_data <- numeric_data |>
   select(-Year, -Economy_status_Developed, -Economy_status_Developing)

cov_matrix <- cov(numeric_data)

print(cov_matrix)
```

Life Expectancy:

```{r}
df |>
  ggplot(aes(y = Life_expectancy, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Life_expectancy, Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



df |>
  ggplot(aes(y = Life_expectancy, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Life_expectancy, Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")




df |>
  ggplot(aes(y = Life_expectancy, x = Under_five_deaths, color = Region)) +
  geom_point()  +
  geom_text(aes(label = paste("Covariance:", round(cov(Life_expectancy, Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



df |>
  ggplot(aes(y = Life_expectancy, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Life_expectancy, Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



df |>
  ggplot(aes(y = Life_expectancy, x = Hepatitis_B, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Life_expectancy, Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



df |>
  ggplot(aes(y = Life_expectancy, x = Measles,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Life_expectancy, Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



df |>
  ggplot(aes(y = Life_expectancy, x =  BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Life_expectancy, BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



df |>
  ggplot(aes(y = Life_expectancy, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Life_expectancy, Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")




df |>
  ggplot(aes(y = Life_expectancy, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Life_expectancy, Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



df |>
  ggplot(aes(y = Life_expectancy, x = Incidents_HIV, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Life_expectancy, Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



df |>
  ggplot(aes(y = Life_expectancy, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Life_expectancy, GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")




df |>
  ggplot(aes(y = Life_expectancy, x = Population_mln, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Life_expectancy, Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


  
df |>
  ggplot(aes(y = Life_expectancy, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Life_expectancy, Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")



  
df |>
  ggplot(aes(y = Life_expectancy, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Life_expectancy, Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Life_expectancy, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Life_expectancy, Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")






```

Inference:

Adult Mortality, Infant Deaths, Under 5 deaths all have a strong negative relationships with Life Expectancy.

Alcohol Consumption, BMI, Polio, Diphteria, and Schooling all have positive relationships with Life Expectancy

Alcohol:

```{r}
df |>
  ggplot(aes(y = Alcohol_consumption, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Alcohol_consumption, Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Alcohol_consumption, Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = Hepatitis_B, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Alcohol_consumption, Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = Measles, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Alcohol_consumption, Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Alcohol_consumption, BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Alcohol_consumption, Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Alcohol_consumption, Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = Incidents_HIV, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Alcohol_consumption, Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Alcohol_consumption, GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = Population_mln, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Alcohol_consumption, Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Alcohol_consumption, x = Schooling, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Alcohol_consumption, Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

GDP:

```{r}

df |>
  ggplot(aes(y = GDP_per_capita, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(GDP_per_capita, Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(GDP_per_capita, Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(GDP_per_capita, Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(GDP_per_capita, Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Hepatitis_B, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(GDP_per_capita, Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(GDP_per_capita, Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Hepatitis_B, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(GDP_per_capita, Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Population_mln, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(GDP_per_capita, Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(GDP_per_capita, Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = GDP_per_capita, x = Thinness_five_nine_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(GDP_per_capita, Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = GDP_per_capita, x = Schooling, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(GDP_per_capita, Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

Adult Mortality

```{r}
df |>
  ggplot(aes(y = Adult_mortality, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Adult_mortality, Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Adult_mortality, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Adult_mortality, Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Adult_mortality, Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Adult_mortality, Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = Hepatitis_B, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Adult_mortality, Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = Measles,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Adult_mortality, Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x =  BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Adult_mortality, BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Adult_mortality, Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Adult_mortality, Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = Incidents_HIV, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Adult_mortality, Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Adult_mortality, GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Adult_mortality, x = Population_mln, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Adult_mortality, Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Adult_mortality, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Adult_mortality, Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Adult_mortality, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Adult_mortality, Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Adult_mortality, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Adult_mortality, Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

```

Hepatitis B

```{r}

df |>
  ggplot(aes(y =  Hepatitis_B, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Hepatitis_B, Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Hepatitis_B, Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Hepatitis_B, Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Hepatitis_B, Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Hepatitis_B, Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = Measles,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Hepatitis_B, Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x =  BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Hepatitis_B, BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Hepatitis_B, Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Hepatitis_B, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Hepatitis_B, Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = Incidents_HIV, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Hepatitis_B, Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Hepatitis_B, GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Hepatitis_B, x = Population_mln, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Hepatitis_B, Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Hepatitis_B, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Hepatitis_B, Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Hepatitis_B, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Hepatitis_B, Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Hepatitis_B, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Hepatitis_B, Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

Measles

```{r}
df |>
  ggplot(aes(y =  Measles, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Measles, Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Measles, Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Measles, Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Measles, Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Measles, Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Hepatitis_B,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Measles, Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x =  BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Measles, BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Measles, Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Measles, Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Incidents_HIV, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Measles, Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Measles, GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Measles, x = Population_mln, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Measles, Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Measles, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Measles, Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Measles, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Measles, Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Measles, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Measles, Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

BMI

```{r}
df |>
  ggplot(aes(y =  BMI, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(BMI, Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(BMI, Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(BMI, Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(BMI, Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(BMI, Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Hepatitis_B,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(BMI, Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x =  Measles, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(BMI, Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(BMI, Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(BMI, Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Incidents_HIV, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(BMI, Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(BMI, GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = BMI, x = Population_mln, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(BMI, Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = BMI, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(BMI, Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = BMI, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(BMI, Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = BMI, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(BMI, Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

Polio

```{r}

df |>
  ggplot(aes(y = Polio, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Polio, Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Polio, Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Polio, Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Polio, Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Polio, Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = Hepatitis_B,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Polio, Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x =  Measles, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Polio, Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Polio, BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Polio, Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = Incidents_HIV, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Polio, Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Polio, GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Polio, x = Population_mln, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Polio, Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Polio, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Polio, Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Polio, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Polio, Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Polio, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Polio, Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

```

Diphtheria

```{r}
df |>
  ggplot(aes(y = Diphtheria, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Diphtheria, Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Diphtheria, Life_expInfant_deathsectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Diphtheria, Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Diphtheria, Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Diphtheria, Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = Hepatitis_B,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Diphtheria, Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x =  Measles, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Diphtheria, Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Diphtheria, BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Diphtheria, Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = Incidents_HIV, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Diphtheria, Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Diphtheria, GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Diphtheria, x = Population_mln, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Diphtheria, Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Diphtheria, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Diphtheria, Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Diphtheria, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Diphtheria, Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Diphtheria, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Diphtheria, Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

HIV

```{r}
df |>
  ggplot(aes(y = Incidents_HIV, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Incidents_HIV, Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Incidents_HIV, Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Incidents_HIV, Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Incidents_HIV, Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Incidents_HIV, Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = Hepatitis_B,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Incidents_HIV, Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x =  Measles, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Incidents_HIV, Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Incidents_HIV, BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Incidents_HIV, Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Incidents_HIV, Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Incidents_HIV, GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Incidents_HIV, x = Population_mln, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Incidents_HIV, Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Incidents_HIV, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Incidents_HIV, Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Incidents_HIV, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Incidents_HIV, Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Incidents_HIV, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Incidents_HIV, Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

Population

```{r}
df |>
  ggplot(aes(y = Population_mln, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Population_mln, Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Population_mln, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Population_mln, Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Population_mln, Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Population_mln, Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Population_mln, Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = Hepatitis_B,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Population_mln, Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x =  Measles, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Population_mln, Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Population_mln, BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Population_mln, Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Population_mln, Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Population_mln, GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")


df |>
  ggplot(aes(y = Population_mln, x = Incidents_HIV, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Population_mln, Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Population_mln, x = Thinness_ten_nineteen_years, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Population_mln, Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Population_mln, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Population_mln, Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

  
df |>
  ggplot(aes(y = Population_mln, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Population_mln, Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

```

Note, Try this again without Asia.

Thinness

```{r}
df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Thinness_ten_nineteen_years, Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Thinness_ten_nineteen_years, Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Thinness_ten_nineteen_years, Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Thinness_ten_nineteen_years, Alcohol_consumption), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Thinness_ten_nineteen_years, Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Hepatitis_B,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Thinness_ten_nineteen_years, Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x =  Measles, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Thinness_ten_nineteen_years, Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Thinness_ten_nineteen_years, BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Thinness_ten_nineteen_years, Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Thinness_ten_nineteen_years, Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Thinness_ten_nineteen_years, GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Incidents_HIV, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Thinness_ten_nineteen_years, Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Population_mln, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Thinness_ten_nineteen_years, Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Thinness_ten_nineteen_years, Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Thinness_ten_nineteen_years, x = Schooling, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Thinness_ten_nineteen_years, Schooling), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

No surprise that the two thinness are basically one to one.

Schooling

```{r}
df |>
  ggplot(aes(y = Schooling, x = Life_expectancy, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Schooling, Life_expectancy), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = Infant_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Schooling, Infant_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = Under_five_deaths, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Schooling, Under_five_deaths), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = Alcohol_consumption, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Schooling, Alcohol_consumption ), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = Adult_mortality, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Schooling, Adult_mortality), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = Hepatitis_B,color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Schooling, Hepatitis_B), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x =  Measles, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Schooling, Measles), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = BMI, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Schooling, BMI), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = Polio, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Schooling, Polio), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = Diphtheria, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Schooling, Diphtheria), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = GDP_per_capita, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Schooling, GDP_per_capita), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")

df |>
  ggplot(aes(y = Schooling, x = Incidents_HIV, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Schooling, Incidents_HIV), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Schooling, x = Population_mln, color = Region)) +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Schooling, Population_mln), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Schooling, x = Thinness_five_nine_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Schooling, Thinness_five_nine_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
  
df |>
  ggplot(aes(y = Schooling, x = Thinness_ten_nineteen_years, color = Region))   +
  geom_point() +
  geom_text(aes(label = paste("Covariance:", round(cov(Schooling, Thinness_ten_nineteen_years), 2))),
            x = Inf, y = Inf, hjust = 1, vjust = 1, color = "black")
```

## 5 Final Conclusions

#### 5.1 Variance Analysis

#### 5.2 Covariance Analysis

Inference: Both European regions have higher rates of alcohol consumption

                       Both European regions have higher life expectancy rates

Conclusion: Alcohol consumption does not greatly affect life expectancy
